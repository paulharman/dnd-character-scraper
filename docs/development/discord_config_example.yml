# Discord Notifier Configuration Example
# This file demonstrates how the data group system would be configured

discord:
  # Discord webhook settings
  webhook_url: "https://discord.com/api/webhooks/your-webhook-url"
  username: "D&D Character Tracker"
  avatar_url: "https://example.com/dnd-icon.png"
  
  # Rate limiting
  rate_limit:
    max_messages_per_minute: 5
    batch_delay_seconds: 2

# Notification group settings
notification_groups:
  # Default behavior when no --include/--exclude specified
  default_include: ["*"]  # All groups
  default_exclude: ["meta"]  # Exclude metadata by default
  
  # Predefined presets for common use cases
  presets:
    combat_only:
      include: ["combat", "spells.slots", "inventory.equipment"]
      exclude: []
      description: "Track only combat-relevant changes"
    
    level_up:
      include: ["progression"]
      exclude: ["meta"]
      description: "Track character advancement"
    
    roleplay_session:
      include: ["background", "appearance", "inventory.wealth"]
      exclude: ["stats", "combat", "spells", "meta"]
      description: "Track story and roleplay elements"
    
    shopping_trip:
      include: ["inventory", "combat.ac"]  # AC might change with new armor
      exclude: ["inventory.wealth"]  # Don't spam wealth changes during shopping
      description: "Track equipment changes"
    
    minimal:
      include: ["basic", "combat.hp"]
      exclude: []
      description: "Only essential changes"
    
    debug:
      include: ["*"]
      exclude: []
      description: "Track everything including metadata"

  # Custom group definitions
  custom_groups:
    # Create a group for essential combat info
    combat_essential:
      fields: ["basic_info.hit_points.current", "basic_info.armor_class.total", "spell_slots.level_1"]
      description: "Essential combat tracking"
    
    # Create a group for wealth changes above a threshold
    significant_wealth:
      fields: ["meta.total_wealth_gp"]
      threshold: 100  # Only notify for changes > 100gp
      description: "Significant wealth changes"
    
    # Create a group for character identity
    identity:
      fields: ["basic_info.name", "basic_info.level", "appearance.avatarUrl"]
      description: "Core character identity"

# Priority-based filtering
priority_settings:
  # Minimum priority level to send notifications
  min_priority: "medium"  # low, medium, high
  
  # Priority overrides for specific groups
  priority_overrides:
    "combat.hp": "high"
    "basic.level": "high"
    "appearance": "low"
    "background": "low"
    "meta": "low"

# Aggregation settings to reduce spam
aggregation:
  # Group changes within time windows
  time_windows:
    immediate: ["combat.hp", "basic.level"]  # Send immediately
    batch_10min: ["inventory.equipment", "spells.known"]  # Batch over 10 minutes
    batch_1hour: ["background", "appearance"]  # Batch over 1 hour
  
  # Maximum changes to include in one message
  max_changes_per_message: 10
  
  # How to handle overflow
  overflow_behavior: "summarize"  # "truncate" or "summarize"

# Formatting settings
formatting:
  # Include old/new values in notifications
  show_old_values: true
  
  # Compact vs detailed format
  format_style: "detailed"  # "compact" or "detailed"
  
  # Include field paths for debugging
  show_field_paths: false
  
  # Group related changes together
  group_related_changes: true
  
  # Emoji indicators for change types
  emojis:
    level_up: "‚¨ÜÔ∏è"
    damage_taken: "üíî"
    healing: "üíö"
    equipment_change: "‚öîÔ∏è"
    spell_learned: "‚ú®"
    wealth_change: "üí∞"

# Character-specific overrides
character_overrides:
  # Override settings for specific characters
  "145081718":  # Ilarion (Wizard)
    presets: ["level_up"]  # This character is frequently leveling
    priority_overrides:
      "spells": "high"  # Wizard spell changes are important
  
  "147061783":  # High-level character
    aggregation:
      batch_1hour: ["spells.known"]  # High-level characters change spells less frequently

# Integration settings
integration:
  # Webhook retry settings
  retry:
    max_attempts: 3
    backoff_multiplier: 2.0
    initial_delay: 1.0
  
  # Backup notification methods
  backup_methods:
    - type: "file"
      path: "/var/log/dnd_changes.log"
    - type: "email"
      smtp_server: "smtp.gmail.com"
      recipients: ["dm@example.com"]
      subject_template: "D&D Character Changes: {character_name}"

# Monitoring and diagnostics
monitoring:
  # Log all filtering decisions
  log_filtering: true
  
  # Track notification statistics
  track_stats: true
  
  # Health check settings
  health_check:
    interval_minutes: 60
    test_message: "Health check - Discord notifier active"